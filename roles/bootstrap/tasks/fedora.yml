---
# bootstrapping tasks file for Fedora hosts
- name: (FEDORA) Clean DNF cache
  ansible.builtin.command: /usr/bin/dnf clean all
  tags:
    - molecule-idempotence-notest

- name: (FEDORA) DNF configuration
  ansible.builtin.lineinfile:
    path: /etc/dnf/dnf.conf
    line: "{{ item }}"
    insertafter: EOF
    state: present
  loop:
    - "fastestmirror=True"              # Automatically chooses the fastest mirror
    - "deltarpm=True"                   # Enable DRPM for diff checking and lightweight downloads
    - "max_parallel_downloads=10"       # Set the maximum parallel downloads to 10

- name: (FEDORA) Update repo cache
  ansible.builtin.dnf:
    update_cache: true
    state: latest

- name: (FEDORA) Upgrade all packages
  ansible.builtin.dnf:
    name: "*"
    state: latest

- name: (FEDORA) Install dnf-plugins-core
  ansible.builtin.dnf:
    name: dnf-plugins-core
    state: present

- name: (FEDORA) Install development and essential code tools
  ansible.builtin.dnf:
    name:
      - git
      - vim
      - python3-pip
      - '@development-tools'
      - '@c-development'
  state: present

- name: (FEDORA) Install net, hardware, monitoring & info tools
  ansible.builtin.dnf:
    name: 
      - htop
      - bpytop
      - neofetch
      - s-tui
      - inxi
      - redhat-lsb-core
      - hwinfo
      - ethtool
      - traceroute
      - lm_sensors
      - lshw
      - hwdata
      - wget
      - curl
      - nmap
      - nmap-ncat
    state: present

- name: (FEDORA) Install security tools
  ansible.builtin.dnf:
    name:
      - ca-certificates
      - acl
      - gnupg
    state: present

- name: (FEDORA) Install file compression & packaging tools
  ansible.builtin.dnf:
    name:
      - zip
      - unzip
      - lzma
      - lzop
      - lzip
      - bzip2
      - sharutils
      - cabextract
      - gzip
      - tar
      - p7zip
      - p7zip-plugins
    state: present

- name: (FEDORA) Install ntfs-3g for NTFS filesystem support
  ansible.builtin.dnf:
    name: ntfs-3g
    state: present
